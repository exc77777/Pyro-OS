<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pyro OS</title>
    <!-- Font Awesome для иконок -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
            user-select: none;
            -webkit-user-select: none;
        }

        body {
            height: 100vh;
            overflow: hidden;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2d2d2d 100%);
            transition: background 0.5s ease;
        }

        body.light-theme {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        /* Стили для экрана блокировки */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #2d2d2d 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            color: white;
            transition: background 0.5s ease;
        }

        body.light-theme .lock-screen {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
        }

        .lock-screen-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            background: 
                linear-gradient(90deg, transparent 24px, rgba(255, 255, 255, 0.03) 25px, transparent 26px),
                linear-gradient(180deg, transparent 24px, rgba(255, 255, 255, 0.03) 25px, transparent 26px);
            background-size: 50px 50px;
            background-position: -1px -1px;
        }

        body.light-theme .lock-screen-bg {
            background: 
                linear-gradient(90deg, transparent 24px, rgba(0, 0, 0, 0.03) 25px, transparent 26px),
                linear-gradient(180deg, transparent 24px, rgba(0, 0, 0, 0.03) 25px, transparent 26px);
        }

        .lock-time {
            font-size: 5rem;
            font-weight: 200;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .lock-date {
            font-size: 1.5rem;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 50px;
        }

        .login-form {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            padding: 30px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            width: 300px;
            transition: all 0.3s ease;
        }

        body.light-theme .login-form {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 30%, #0066ff, transparent 50%),
                radial-gradient(circle at 70% 70%, #0099ff, transparent 50%),
                radial-gradient(circle at 50% 20%, #00aaff, transparent 50%);
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.4);
            position: relative;
            overflow: hidden;
            font-size: 2rem;
            font-weight: bold;
            color: white;
        }

        body.light-theme .user-avatar {
            background: 
                radial-gradient(circle at 30% 30%, #4fc3f7, transparent 50%),
                radial-gradient(circle at 70% 70%, #29b6f6, transparent 50%);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
        }

        .user-avatar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, #0044cc, transparent 40%),
                radial-gradient(circle at 80% 20%, #0088ff, transparent 40%);
            mix-blend-mode: overlay;
        }

        .username {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 500;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .username:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .username {
            color: #333;
        }

        body.light-theme .username:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .username-input {
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            color: white;
            padding: 4px 8px;
            font-size: 1rem;
            text-align: center;
            outline: none;
            width: 120px;
        }

        body.light-theme .username-input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.3);
            color: #333;
        }

        .password-input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            font-size: 16px;
            margin-bottom: 15px;
            outline: none;
            text-align: center;
            transition: all 0.3s ease;
        }

        body.light-theme .password-input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: #333;
        }

        .password-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        body.light-theme .password-input::placeholder {
            color: rgba(0, 0, 0, 0.5);
        }

        .login-button {
            width: 100%;
            padding: 12px;
            background: #0066ff;
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .login-button:hover {
            background: #0055dd;
        }

        .error-message {
            color: #ff4444;
            margin-top: 10px;
            font-size: 14px;
            display: none;
        }

        /* Стили для рабочего стола */
        .desktop-interface {
            display: none;
            height: 100vh;
            overflow: hidden;
            flex-direction: column;
            position: relative;
        }

        .animated-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            background: 
                linear-gradient(90deg, transparent 24px, rgba(255, 255, 255, 0.03) 25px, transparent 26px),
                linear-gradient(180deg, transparent 24px, rgba(255, 255, 255, 0.03) 25px, transparent 26px);
            background-size: 50px 50px;
            background-position: -1px -1px;
            transition: background 0.5s ease;
        }

        body.light-theme .animated-bg {
            background: 
                linear-gradient(90deg, transparent 24px, rgba(0, 0, 0, 0.03) 25px, transparent 26px),
                linear-gradient(180deg, transparent 24px, rgba(0, 0, 0, 0.03) 25px, transparent 26px);
        }

        .cursor-follower {
            position: absolute;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(0, 102, 255, 0.1) 0%, rgba(0, 102, 255, 0) 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            transition: transform 0.15s ease-out;
        }

        body.light-theme .cursor-follower {
            background: radial-gradient(circle, rgba(33, 150, 243, 0.1) 0%, rgba(33, 150, 243, 0) 70%);
        }

        .desktop {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            padding-top: 146px;
            transition: color 0.5s ease;
        }

        body.light-theme .desktop {
            color: #333;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.5);
        }

        .time-display {
            font-size: 5rem;
            font-weight: 200;
            margin-bottom: 10px;
            letter-spacing: 2px;
            cursor: default;
        }

        .date-display {
            font-size: 1.5rem;
            font-weight: 300;
            opacity: 0.9;
            cursor: default;
        }

        /* Прозрачная панель задач */
        .taskbar {
            height: 48px;
            background-color: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            padding: 0 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.5s ease;
        }

        body.light-theme .taskbar {
            background-color: rgba(255, 255, 255, 0.7);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .start-button {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            margin-right: 10px;
            background: #2d2d2d;
            position: relative;
            overflow: hidden;
        }

        body.light-theme .start-button {
            background: #f0f0f0;
        }

        .start-button:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }

        body.light-theme .start-button:hover {
            background-color: #e0e0e0;
        }

        /* Новая иконка меню Пуск */
        .start-button svg {
            width: 24px;
            height: 24px;
            fill: #0066ff;
            transition: all 0.3s ease;
        }

        body.light-theme .start-button svg {
            fill: #2196f3;
        }

        .start-button:hover svg {
            transform: scale(1.1);
        }

        .taskbar-apps {
            display: flex;
            align-items: center;
            flex: 1;
            justify-content: flex-start;
            gap: 2px;
        }

        .taskbar-app {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .taskbar-app:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .taskbar-app:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .taskbar-app.active {
            background-color: rgba(255, 255, 255, 0.15);
        }

        body.light-theme .taskbar-app.active {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .taskbar-app.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 2px;
            background: #0066ff;
            border-radius: 1px;
        }

        body.light-theme .taskbar-app.active::before {
            background: #2196f3;
        }

        .taskbar-app i {
            font-size: 18px;
            color: white;
        }

        body.light-theme .taskbar-app i {
            color: #333;
        }

        .taskbar-app svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .taskbar-right {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.2s;
            cursor: pointer;
            height: 100%;
        }

        body.light-theme .taskbar-right {
            color: #333;
        }

        .taskbar-right:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .taskbar-right:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .taskbar-time {
            font-size: 14px;
            font-weight: 500;
            line-height: 1.2;
        }

        .taskbar-date {
            font-size: 11px;
            opacity: 0.8;
            line-height: 1.2;
        }

        /* Календарь */
        .calendar {
            position: absolute;
            bottom: 60px;
            right: 10px;
            width: 320px;
            background: rgba(40, 40, 40, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.15);
            display: none;
            z-index: 1000;
            animation: calendarAppear 0.2s ease-out;
            transition: all 0.3s ease;
        }

        body.light-theme .calendar {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            color: #333;
        }

        @keyframes calendarAppear {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-nav {
            display: flex;
            gap: 10px;
        }

        .calendar-nav-button {
            width: 30px;
            height: 30px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        body.light-theme .calendar-nav-button {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .calendar-nav-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        body.light-theme .calendar-nav-button:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .calendar-month {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }

        body.light-theme .calendar-month {
            color: #333;
        }

        .calendar-year {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        body.light-theme .calendar-year {
            color: rgba(0, 0, 0, 0.7);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 15px;
            min-height: 200px;
        }

        .calendar-day {
            text-align: center;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            padding: 4px;
        }

        body.light-theme .calendar-day {
            color: rgba(0, 0, 0, 0.5);
        }

        .calendar-date {
            text-align: center;
            font-size: 12px;
            color: white;
            padding: 6px;
            border-radius: 4px;
            cursor: default;
            transition: all 0.2s ease;
            position: relative;
            min-height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.light-theme .calendar-date {
            color: #333;
        }

        .calendar-date:hover {
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        body.light-theme .calendar-date:hover {
            background: rgba(0, 0, 0, 0.05);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .calendar-date.today {
            background: #0066ff;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 102, 255, 0.4);
        }

        body.light-theme .calendar-date.today {
            background: #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.4);
        }

        .calendar-date.other-month {
            opacity: 0.3;
        }

        .calendar-date.halloween::after {
            content: '🎃';
            position: absolute;
            top: -2px;
            right: 0px;
            font-size: 10px;
            background: none;
        }

        .calendar-date.christmas::after {
            content: '🎄';
            position: absolute;
            top: -2px;
            right: 0px;
            font-size: 10px;
            background: none;
        }

        .calendar-date.new-year::after {
            content: '🎄';
            position: absolute;
            top: -2px;
            right: 0px;
            font-size: 10px;
            background: none;
        }

        .calendar-time {
            text-align: center;
            font-size: 20px;
            font-weight: 300;
            color: white;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }

        body.light-theme .calendar-time {
            color: #333;
        }

        .calendar-full-date {
            text-align: center;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        body.light-theme .calendar-full-date {
            color: rgba(0, 0, 0, 0.8);
        }

        /* Улучшенное меню Пуск с анимацией */
        .start-menu {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 600px;
            background: rgba(40, 40, 40, 0.95);
            backdrop-filter: blur(40px);
            border-radius: 16px;
            display: none;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.15);
            z-index: 1000;
            animation: menuAppear 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-origin: bottom center;
            transition: all 0.3s ease;
        }

        body.light-theme .start-menu {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.15);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .start-menu.closing {
            animation: menuDisappear 0.25s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        @keyframes menuAppear {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8) translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) scale(1) translateY(0);
            }
        }

        @keyframes menuDisappear {
            0% {
                opacity: 1;
                transform: translateX(-50%) scale(1) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scale(0.8) translateY(20px);
            }
        }

        .start-menu-header {
            padding: 50px 50px 25px;
            color: white;
            text-align: center;
            position: relative;
        }

        body.light-theme .start-menu-header {
            color: #333;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        body.light-theme .theme-toggle {
            background: rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.2);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        body.light-theme .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .start-menu-header h2 {
            font-size: 54px;
            font-weight: 700;
            margin-bottom: 12px;
            background: linear-gradient(90deg, #0066ff, #0099ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        body.light-theme .start-menu-header h2 {
            background: linear-gradient(90deg, #2196f3, #03a9f4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .start-menu-content {
            display: flex;
            flex-direction: column;
            height: calc(100% - 170px);
            padding: 0 50px;
            align-items: center;
            justify-content: center;
        }

        .apps-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 25px;
        }

        .app-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            background: rgba(255, 255, 255, 0.05);
        }

        body.light-theme .app-item {
            color: #333;
            background: rgba(0, 0, 0, 0.05);
        }

        .app-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        body.light-theme .app-item:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .app-item svg {
            width: 54px;
            height: 54px;
            margin-bottom: 14px;
            fill: currentColor;
        }

        .app-item i {
            font-size: 54px;
            margin-bottom: 14px;
            color: white;
        }

        body.light-theme .app-item i {
            color: #333;
        }

        .app-item span {
            font-size: 16px;
            text-align: center;
            font-weight: 400;
        }

        .user-profile {
            position: absolute;
            bottom: 40px;
            left: 25px;
            display: flex;
            align-items: center;
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        body.light-theme .user-profile {
            color: #333;
        }

        .user-profile:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .user-profile:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .user-profile-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 30%, #0066ff, transparent 50%),
                radial-gradient(circle at 70% 70%, #0099ff, transparent 50%);
            margin-right: 10px;
            box-shadow: 0 2px 8px rgba(0, 102, 255, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            color: white;
        }

        body.light-theme .user-profile-avatar {
            background: 
                radial-gradient(circle at 30% 30%, #2196f3, transparent 50%),
                radial-gradient(circle at 70% 70%, #03a9f4, transparent 50%);
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.4);
        }

        .menu-username {
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .menu-username:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .menu-username:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .lock-button {
            position: absolute;
            bottom: 40px;
            right: 25px;
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            background: rgba(255, 255, 255, 0.05);
        }

        body.light-theme .lock-button {
            color: #333;
            background: rgba(0, 0, 0, 0.05);
        }

        .lock-button:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        body.light-theme .lock-button:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .lock-button span {
            font-size: 14px;
            font-weight: 400;
        }

        /* Стили для окон */
        .window {
            position: absolute;
            width: 320px;
            background-color: rgba(50, 50, 50, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: none;
            overflow: hidden;
            flex-direction: column;
            z-index: 100;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.1s ease-out;
        }

        body.light-theme .window {
            background-color: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .window.minimized {
            transform: scale(0.1);
            opacity: 0;
            pointer-events: none;
        }

        .window.maximized {
            width: 100vw !important;
            height: calc(100vh - 48px) !important;
            left: 0 !important;
            top: 0 !important;
            transform: none !important;
            border-radius: 0;
            border: none;
        }

        .window.maximized .calculator {
            width: 100%;
            height: 100%;
            padding: 40px;
        }

        .window.maximized .calculator-display {
            font-size: 4rem;
            min-height: 120px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .window.maximized .calculator-buttons {
            height: calc(100% - 150px);
            gap: 15px;
        }

        .window.maximized .calc-btn {
            font-size: 2rem;
            border-radius: 12px;
        }

        .window-header {
            height: 40px;
            background-color: rgba(60, 60, 60, 0.9);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 0 0 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: move;
            transition: all 0.3s ease;
        }

        body.light-theme .window-header {
            background-color: rgba(240, 240, 240, 0.9);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .window-title {
            font-size: 14px;
            color: white;
            font-weight: 500;
        }

        body.light-theme .window-title {
            color: #333;
        }

        .window-controls {
            display: flex;
            gap: 0;
            height: 100%;
        }

        .window-control {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
            color: white;
            font-size: 16px;
            border-radius: 0;
        }

        body.light-theme .window-control {
            color: #333;
        }

        .window-control:first-child {
            border-radius: 0;
        }

        .window-control:last-child {
            border-radius: 0 12px 0 0;
        }

        .window-control:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        body.light-theme .window-control:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .window-control.close:hover {
            background-color: #ff4444;
            border-radius: 0 12px 0 0;
            color: white;
        }

        .window-content {
            flex: 1;
            padding: 0;
            overflow: hidden;
        }

        /* Стили для калькулятора */
        .calculator {
            width: 100%;
            background: #2d2d2d;
            padding: 20px;
            height: 400px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        body.light-theme .calculator {
            background: #f5f5f5;
        }

        .calculator-display {
            background: #1a1a1a;
            color: white;
            font-size: 2rem;
            text-align: right;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            word-break: break-all;
            border: 1px solid rgba(255, 255, 255, 0.1);
            font-family: 'Courier New', monospace;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        body.light-theme .calculator-display {
            background: #ffffff;
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            flex: 1;
            min-height: 0;
        }

        .calc-btn {
            background: #3d3d3d;
            color: white;
            border: none;
            font-size: 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.light-theme .calc-btn {
            background: #e0e0e0;
            color: #333;
        }

        .calc-btn:hover {
            background: #4d4d4d;
        }

        body.light-theme .calc-btn:hover {
            background: #d5d5d5;
        }

        .calc-btn.operator {
            background: #ff8c42;
        }

        .calc-btn.operator:hover {
            background: #ff7b2e;
        }

        .calc-btn.equals {
            background: #ff8c42;
            grid-row: span 2;
        }

        .calc-btn.equals:hover {
            background: #ff7b2e;
        }

        .calc-btn.clear {
            background: #ff4444;
        }

        .calc-btn.clear:hover {
            background: #ff5555;
        }

        .calc-btn.backspace {
            background: #ff4444;
            font-weight: 900;
            font-size: 1.6rem;
            position: relative;
        }

        .calc-btn.backspace:hover {
            background: #ff5555;
        }

        .calc-btn.zero {
            grid-column: span 2;
        }

        .calc-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .calc-btn:disabled:hover {
            background: #3d3d3d;
        }

        body.light-theme .calc-btn:disabled:hover {
            background: #e0e0e0;
        }

        /* Стили для блокнота */
        .notepad {
            width: 100%;
            height: 500px;
            background: #2d2d2d;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        body.light-theme .notepad {
            background: #f5f5f5;
        }

        .notepad-toolbar {
            height: 40px;
            background: #3d3d3d;
            display: flex;
            align-items: center;
            padding: 0 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            gap: 10px;
        }

        body.light-theme .notepad-toolbar {
            background: #e0e0e0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .notepad-button {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        body.light-theme .notepad-button {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .notepad-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        body.light-theme .notepad-button:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .notepad-textarea {
            flex: 1;
            background: #1a1a1a;
            border: none;
            color: white;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
        }

        body.light-theme .notepad-textarea {
            background: #ffffff;
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        /* Стили для таймера и секундомера */
        .timer {
            width: 100%;
            height: 400px;
            background: #2d2d2d;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        body.light-theme .timer {
            background: #f5f5f5;
        }

        .timer-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .timer-tab {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        body.light-theme .timer-tab {
            background: rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .timer-tab.active {
            background: #0066ff;
        }

        body.light-theme .timer-tab.active {
            background: #2196f3;
        }

        .timer-display {
            font-size: 3rem;
            font-weight: 200;
            color: white;
            margin-bottom: 30px;
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
        }

        body.light-theme .timer-display {
            color: #333;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .timer-button {
            padding: 10px 20px;
            background: #0066ff;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .timer-button:hover {
            background: #0055dd;
        }

        .timer-button.reset {
            background: #ff4444;
        }

        .timer-button.reset:hover {
            background: #ff5555;
        }

        .timer-input {
            width: 200px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            color: white;
            font-size: 16px;
            text-align: center;
            margin-bottom: 20px;
        }

        body.light-theme .timer-input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.2);
            color: #333;
        }

        .timer-laps {
            width: 100%;
            max-height: 150px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 10px;
        }

        body.light-theme .timer-laps {
            background: rgba(0, 0, 0, 0.05);
        }

        .lap-item {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        body.light-theme .lap-item {
            color: #333;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        /* Круговой таймер */
        .circular-timer {
            position: relative;
            width: 200px;
            height: 200px;
            margin-bottom: 20px;
        }

        .circular-timer-svg {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .circular-timer-background {
            fill: none;
            stroke: rgba(255, 255, 255, 0.1);
            stroke-width: 8;
        }

        body.light-theme .circular-timer-background {
            stroke: rgba(0, 0, 0, 0.1);
        }

        .circular-timer-progress {
            fill: none;
            stroke: #0066ff;
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.1s linear;
        }

        body.light-theme .circular-timer-progress {
            stroke: #2196f3;
        }

        .circular-timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            font-weight: 200;
            color: white;
            font-family: 'Courier New', monospace;
        }

        body.light-theme .circular-timer-text {
            color: #333;
        }
    </style>
</head>
<body>
    <!-- Экран блокировки -->
    <div class="lock-screen" id="lockScreen">
        <div class="lock-screen-bg"></div>
        <div class="lock-time" id="lockTime">00:00:00</div>
        <div class="lock-date" id="lockDate">Понедельник, 1 января</div>
        
        <div class="login-form">
            <div class="user-avatar" id="lockAvatar">EXC</div>
            <div class="username" id="lockUsername" onclick="editUsername('lock')">exc</div>
            <input type="password" class="password-input" id="passwordInput" placeholder="Введите пароль" onkeypress="handlePasswordKeypress(event)">
            <button class="login-button" onclick="login()">Войти</button>
            <div class="error-message" id="errorMessage">Неверный пароль. Попробуйте снова.</div>
        </div>
    </div>

    <!-- Рабочий стол -->
    <div class="desktop-interface" id="desktopInterface">
        <div class="animated-bg" id="animated-bg"></div>
        <div class="cursor-follower" id="cursorFollower"></div>

        <div class="desktop">
            <div class="time-display" id="current-time">00:00:00</div>
            <div class="date-display" id="current-date">Понедельник, 1 января</div>
        </div>

        <!-- Календарь -->
        <div class="calendar" id="calendar">
            <div class="calendar-header">
                <div class="calendar-nav">
                    <button class="calendar-nav-button" onclick="changeCalendarMonth(-1)">‹</button>
                    <button class="calendar-nav-button" onclick="changeCalendarMonth(1)">›</button>
                </div>
                <div class="calendar-month" id="calendarMonth">Январь</div>
                <div class="calendar-year" id="calendarYear">2024</div>
            </div>
            <div class="calendar-grid" id="calendarDays">
                <!-- Дни недели -->
                <div class="calendar-day">Пн</div>
                <div class="calendar-day">Вт</div>
                <div class="calendar-day">Ср</div>
                <div class="calendar-day">Чт</div>
                <div class="calendar-day">Пт</div>
                <div class="calendar-day">Сб</div>
                <div class="calendar-day">Вс</div>
                <!-- Даты будут добавлены через JS -->
            </div>
            <div class="calendar-time" id="calendarTime">00:00:00</div>
            <div class="calendar-full-date" id="calendarFullDate">1 января 2024</div>
        </div>

        <!-- Прозрачная панель задач -->
        <div class="taskbar">
            <div class="start-button" onclick="toggleStartMenu()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                    <path d="M96 157.7L279.6 132.4L279.6 309.8L96 309.8L96 157.7zM96 482.3L279.6 507.6L279.6 332.4L96 332.4L96 482.3zM299.8 510.3L544 544L544 332.4L299.8 332.4L299.8 510.3zM299.8 129.7L299.8 309.8L544 309.8L544 96L299.8 129.7z"/>
                </svg>
            </div>
            <div class="taskbar-apps" id="taskbarApps">
                <!-- Приложения будут добавляться динамически -->
            </div>
            <div class="taskbar-right" onclick="toggleCalendar()">
                <div class="taskbar-time" id="taskbar-time">00:00:00</div>
                <div class="taskbar-date" id="taskbar-date">01/01/2024</div>
            </div>
        </div>

        <!-- Улучшенное меню Пуск -->
        <div class="start-menu" id="start-menu">
            <div class="start-menu-header">
                <div class="theme-toggle" id="themeToggle" onclick="toggleTheme()">
                    🌙
                </div>
                <h2>Pyro OS</h2>
            </div>
            
            <div class="start-menu-content">
                <div class="apps-grid">
                    <div class="app-item" onclick="openWindow('calculator')">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640">
                            <path d="M192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 128C512 92.7 483.3 64 448 64L192 64zM224 128L416 128C433.7 128 448 142.3 448 160L448 192C448 209.7 433.7 224 416 224L224 224C206.3 224 192 209.7 192 192L192 160C192 142.3 206.3 128 224 128zM240 296C240 309.3 229.3 320 216 320C202.7 320 192 309.3 192 296C192 282.7 202.7 272 216 272C229.3 272 240 282.7 240 296zM320 320C306.7 320 296 309.3 296 296C296 282.7 306.7 272 320 272C333.3 272 344 282.7 344 296C344 309.3 333.3 320 320 320zM448 296C448 309.3 437.3 320 424 320C410.7 320 400 309.3 400 296C400 282.7 410.7 272 424 272C437.3 272 448 282.7 448 296zM216 416C202.7 416 192 405.3 192 392C192 378.7 202.7 368 216 368C229.3 368 240 378.7 240 392C240 405.3 229.3 416 216 416zM344 392C344 405.3 333.3 416 320 416C306.7 416 296 405.3 296 392C296 378.7 306.7 368 320 368C333.3 368 344 378.7 344 392zM424 416C410.7 416 400 405.3 400 392C400 378.7 410.7 368 424 368C437.3 368 448 378.7 448 392C448 405.3 437.3 416 424 416zM192 488C192 474.7 202.7 464 216 464L328 464C341.3 464 352 474.7 352 488C352 501.3 341.3 512 328 512L216 512C202.7 512 192 501.3 192 488zM424 464C437.3 464 448 474.7 448 488C448 501.3 437.3 512 424 512C410.7 512 400 501.3 400 488C400 474.7 410.7 464 424 464z"/>
                        </svg>
                        <span>Калькулятор</span>
                    </div>
                    <div class="app-item" onclick="openWindow('notepad')">
                        <i class="fa-solid fa-file-lines"></i>
                        <span>Блокнот</span>
                    </div>
                    <div class="app-item" onclick="openWindow('timer')">
                        <i class="fa-solid fa-stopwatch"></i>
                        <span>Таймер</span>
                    </div>
                </div>
            </div>
            
            <div class="user-profile">
                <div class="user-profile-avatar" id="menuAvatar">EXC</div>
                <span class="menu-username" id="menuUsername" onclick="editUsername('menu')">exc</span>
            </div>
            
            <div class="lock-button" onclick="lockScreen()">
                <span>Заблокировать</span>
            </div>
        </div>

        <!-- Окно калькулятора -->
        <div class="window" id="calculator">
            <div class="window-header">
                <div class="window-title">Калькулятор</div>
                <div class="window-controls">
                    <div class="window-control minimize" onclick="minimizeWindow('calculator')">−</div>
                    <div class="window-control maximize" onclick="maximizeWindow('calculator')">□</div>
                    <div class="window-control close" onclick="closeWindow('calculator')">×</div>
                </div>
            </div>
            <div class="window-content">
                <div class="calculator">
                    <div class="calculator-display" id="calcDisplay">0</div>
                    <div class="calculator-buttons">
                        <button class="calc-btn clear" onclick="clearCalculator()">C</button>
                        <button class="calc-btn backspace" onclick="backspace()">←</button>
                        <button class="calc-btn operator" onclick="appendToDisplay('/')">/</button>
                        <button class="calc-btn operator" onclick="appendToDisplay('×')">×</button>
                        
                        <button class="calc-btn" onclick="appendToDisplay('7')">7</button>
                        <button class="calc-btn" onclick="appendToDisplay('8')">8</button>
                        <button class="calc-btn" onclick="appendToDisplay('9')">9</button>
                        <button class="calc-btn operator" onclick="appendToDisplay('-')">-</button>
                        
                        <button class="calc-btn" onclick="appendToDisplay('4')">4</button>
                        <button class="calc-btn" onclick="appendToDisplay('5')">5</button>
                        <button class="calc-btn" onclick="appendToDisplay('6')">6</button>
                        <button class="calc-btn operator" onclick="appendToDisplay('+')">+</button>
                        
                        <button class="calc-btn" onclick="appendToDisplay('1')">1</button>
                        <button class="calc-btn" onclick="appendToDisplay('2')">2</button>
                        <button class="calc-btn" onclick="appendToDisplay('3')">3</button>
                        <button class="calc-btn equals" onclick="calculate()">=</button>
                        
                        <button class="calc-btn zero" onclick="appendToDisplay('0')">0</button>
                        <button class="calc-btn" id="decimalBtn" onclick="appendToDisplay('.')">.</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Окно блокнота -->
        <div class="window" id="notepad" style="width: 500px; height: 400px;">
            <div class="window-header">
                <div class="window-title">Блокнот</div>
                <div class="window-controls">
                    <div class="window-control minimize" onclick="minimizeWindow('notepad')">−</div>
                    <div class="window-control maximize" onclick="maximizeWindow('notepad')">□</div>
                    <div class="window-control close" onclick="closeWindow('notepad')">×</div>
                </div>
            </div>
            <div class="window-content">
                <div class="notepad">
                    <div class="notepad-toolbar">
                        <button class="notepad-button" onclick="saveNote()">Сохранить</button>
                        <button class="notepad-button" onclick="clearNote()">Очистить</button>
                    </div>
                    <textarea class="notepad-textarea" id="notepadText" placeholder="Начните вводить текст..."></textarea>
                </div>
            </div>
        </div>

        <!-- Окно таймера и секундомера -->
        <div class="window" id="timer" style="width: 350px; height: 450px;">
            <div class="window-header">
                <div class="window-title">Таймер и секундомер</div>
                <div class="window-controls">
                    <div class="window-control minimize" onclick="minimizeWindow('timer')">−</div>
                    <div class="window-control maximize" onclick="maximizeWindow('timer')">□</div>
                    <div class="window-control close" onclick="closeWindow('timer')">×</div>
                </div>
            </div>
            <div class="window-content">
                <div class="timer">
                    <div class="timer-tabs">
                        <button class="timer-tab active" onclick="switchTab('stopwatch')">Секундомер</button>
                        <button class="timer-tab" onclick="switchTab('countdown')">Таймер</button>
                    </div>
                    
                    <div id="stopwatchTab">
                        <div class="timer-display" id="stopwatchDisplay">00:00:00</div>
                        <div class="timer-controls">
                            <button class="timer-button" id="startStopwatch" onclick="toggleStopwatch()">Старт</button>
                            <button class="timer-button" onclick="lapStopwatch()">Круг</button>
                            <button class="timer-button reset" onclick="resetStopwatch()">Сброс</button>
                        </div>
                        <div class="timer-laps" id="stopwatchLaps"></div>
                    </div>
                    
                    <div id="countdownTab" style="display: none;">
                        <div class="circular-timer">
                            <svg class="circular-timer-svg" viewBox="0 0 100 100">
                                <circle class="circular-timer-background" cx="50" cy="50" r="45"></circle>
                                <circle class="circular-timer-progress" cx="50" cy="50" r="45" 
                                        stroke-dasharray="283" stroke-dashoffset="283"></circle>
                            </svg>
                            <div class="circular-timer-text" id="circularTimerText">00:00</div>
                        </div>
                        <input type="text" class="timer-input" id="countdownInput" placeholder="ММ:СС">
                        <div class="timer-controls">
                            <button class="timer-button" id="startCountdown" onclick="toggleCountdown()">Старт</button>
                            <button class="timer-button reset" onclick="resetCountdown()">Сброс</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Система авторизации
        function login() {
            const password = document.getElementById('passwordInput').value;
            const errorMessage = document.getElementById('errorMessage');
            
            if (password === '123') {
                document.getElementById('lockScreen').style.display = 'none';
                document.getElementById('desktopInterface').style.display = 'flex';
                initDesktop();
            } else {
                errorMessage.style.display = 'block';
                document.getElementById('passwordInput').value = '';
            }
        }

        function handlePasswordKeypress(event) {
            if (event.key === 'Enter') {
                login();
            }
        }

        function lockScreen() {
            document.getElementById('desktopInterface').style.display = 'none';
            document.getElementById('lockScreen').style.display = 'flex';
            document.getElementById('passwordInput').value = '';
            document.getElementById('errorMessage').style.display = 'none';
            hideCalendar();
        }

        // Обновление времени на экране блокировки
        function updateLockTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit', second:'2-digit'});
            const dateString = now.toLocaleDateString('ru-RU', {weekday: 'long', day: 'numeric', month: 'long'});
            
            document.getElementById('lockTime').textContent = timeString;
            document.getElementById('lockDate').textContent = dateString;
        }

        setInterval(updateLockTime, 1000);
        updateLockTime();

        // Инициализация рабочего стола
        function initDesktop() {
            initCursorEffect();
            updateCalendar();
            initDraggableWindows();
            loadUsername();
        }

        // Эффект следования за курсором с разной скоростью
        function initCursorEffect() {
            const follower = document.getElementById('cursorFollower');
            let mouseX = 0, mouseY = 0;
            let followerX = 0, followerY = 0;
            
            document.addEventListener('mousemove', function(e) {
                mouseX = e.clientX;
                mouseY = e.clientY;
            });
            
            function animate() {
                // Для курсора - медленное следование с задержкой
                const dx = mouseX - followerX - 50;
                const dy = mouseY - followerY - 50;
                
                followerX += dx * 0.1; // Медленная скорость для курсора
                followerY += dy * 0.1;
                
                follower.style.left = followerX + 'px';
                follower.style.top = followerY + 'px';
                
                requestAnimationFrame(animate);
            }
            
            animate();
        }
        
        // Обновление времени на рабочем столе
        function updateDesktopTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit', second:'2-digit'});
            const dateString = now.toLocaleDateString('ru-RU', {weekday: 'long', day: 'numeric', month: 'long'});
            const shortDate = now.toLocaleDateString('ru-RU', {day: '2-digit', month: '2-digit', year: 'numeric'}).replace(/\./g, '/');
            
            document.getElementById('current-time').textContent = timeString;
            document.getElementById('taskbar-time').textContent = timeString;
            document.getElementById('current-date').textContent = dateString;
            document.getElementById('taskbar-date').textContent = shortDate;
        }
        
        setInterval(updateDesktopTime, 1000);
        updateDesktopTime();

        // Функции для работы с ником
        function loadUsername() {
            const savedUsername = localStorage.getItem('pyroUsername');
            const savedAvatar = localStorage.getItem('pyroAvatar');
            
            if (savedUsername) {
                document.getElementById('lockUsername').textContent = savedUsername;
                document.getElementById('menuUsername').textContent = savedUsername;
            }
            
            if (savedAvatar) {
                document.getElementById('lockAvatar').textContent = savedAvatar;
                document.getElementById('menuAvatar').textContent = savedAvatar;
            }
        }

        function editUsername(location) {
            const usernameElement = document.getElementById(location === 'lock' ? 'lockUsername' : 'menuUsername');
            const currentUsername = usernameElement.textContent;
            
            // Создаем input для редактирования
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'username-input';
            input.value = currentUsername;
            input.maxLength = 15;
            
            // Заменяем отображение на input
            usernameElement.style.display = 'none';
            usernameElement.parentNode.insertBefore(input, usernameElement.nextSibling);
            
            // Фокус и выделение текста
            input.focus();
            input.select();
            
            // Сохранение при потере фокуса или нажатии Enter
            function saveUsername() {
                const newUsername = input.value.trim();
                
                if (newUsername && newUsername !== currentUsername) {
                    // Сохраняем новое имя
                    document.getElementById('lockUsername').textContent = newUsername;
                    document.getElementById('menuUsername').textContent = newUsername;
                    
                    // Обновляем аватар (первые 3 символа)
                    const avatarText = newUsername.substring(0, 3).toUpperCase();
                    document.getElementById('lockAvatar').textContent = avatarText;
                    document.getElementById('menuAvatar').textContent = avatarText;
                    
                    // Сохраняем в localStorage
                    localStorage.setItem('pyroUsername', newUsername);
                    localStorage.setItem('pyroAvatar', avatarText);
                }
                
                // Восстанавливаем отображение
                input.remove();
                usernameElement.style.display = 'block';
                
                // Удаляем обработчики событий
                input.removeEventListener('blur', saveUsername);
                input.removeEventListener('keypress', handleKeypress);
            }
            
            function handleKeypress(e) {
                if (e.key === 'Enter') {
                    saveUsername();
                }
            }
            
            input.addEventListener('blur', saveUsername);
            input.addEventListener('keypress', handleKeypress);
        }

        // Календарь с праздниками и навигацией - ВСЕГДА показывает текущую дату
        let currentCalendarDate = new Date();

        function updateCalendar() {
            const now = currentCalendarDate;
            const calendarTime = document.getElementById('calendarTime');
            const calendarFullDate = document.getElementById('calendarFullDate');
            const calendarMonth = document.getElementById('calendarMonth');
            const calendarYear = document.getElementById('calendarYear');
            const calendarDays = document.getElementById('calendarDays');
            
            // Время и дата с секундами - ВСЕГДА текущее время
            const currentTime = new Date();
            calendarTime.textContent = currentTime.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit', second:'2-digit'});
            
            // Полная дата - ВСЕГДА текущая дата
            const today = new Date();
            calendarFullDate.textContent = today.toLocaleDateString('ru-RU', {day: 'numeric', month: 'long', year: 'numeric'});
            
            // Месяц и год - те, которые просматриваются
            calendarMonth.textContent = now.toLocaleDateString('ru-RU', {month: 'long'});
            calendarYear.textContent = now.getFullYear();
            
            // Очистка предыдущих дат (оставляем только дни недели)
            while (calendarDays.children.length > 7) {
                calendarDays.removeChild(calendarDays.lastChild);
            }
            
            // Генерация календаря
            const firstDay = new Date(now.getFullYear(), now.getMonth(), 1);
            const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);
            
            // Пустые ячейки до первого дня
            let firstDayOfWeek = firstDay.getDay();
            firstDayOfWeek = firstDayOfWeek === 0 ? 6 : firstDayOfWeek - 1;
            
            // Добавляем дни предыдущего месяца с праздниками
            const prevMonthLastDay = new Date(now.getFullYear(), now.getMonth(), 0).getDate();
            for (let i = firstDayOfWeek - 1; i >= 0; i--) {
                const day = prevMonthLastDay - i;
                const dateCell = document.createElement('div');
                dateCell.className = 'calendar-date other-month';
                dateCell.textContent = day;
                
                // Проверка на праздники для дней предыдущего месяца
                const cellDate = new Date(now.getFullYear(), now.getMonth() - 1, day);
                if (cellDate.getMonth() === 9 && cellDate.getDate() === 31) { // Хэллоуин 31 октября
                    dateCell.classList.add('halloween');
                } else if (cellDate.getMonth() === 11 && cellDate.getDate() === 31) { // Новый год 31 декабря
                    dateCell.classList.add('new-year');
                } else if (cellDate.getMonth() === 0 && cellDate.getDate() === 1) { // Рождество 1 января
                    dateCell.classList.add('christmas');
                }
                
                calendarDays.appendChild(dateCell);
            }
            
            // Дни текущего месяца с праздниками
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dateCell = document.createElement('div');
                dateCell.className = 'calendar-date';
                
                // Проверка на сегодня - сравниваем с реальной сегодняшней датой
                const cellDate = new Date(now.getFullYear(), now.getMonth(), day);
                if (cellDate.getDate() === today.getDate() && 
                    cellDate.getMonth() === today.getMonth() && 
                    cellDate.getFullYear() === today.getFullYear()) {
                    dateCell.classList.add('today');
                }
                
                // Проверка на праздники
                if (cellDate.getMonth() === 9 && cellDate.getDate() === 31) { // Хэллоуин 31 октября
                    dateCell.classList.add('halloween');
                } else if (cellDate.getMonth() === 11 && cellDate.getDate() === 31) { // Новый год 31 декабря
                    dateCell.classList.add('new-year');
                } else if (cellDate.getMonth() === 0 && cellDate.getDate() === 1) { // Рождество 1 января
                    dateCell.classList.add('christmas');
                }
                
                dateCell.textContent = day;
                calendarDays.appendChild(dateCell);
            }
            
            // Добавляем дни следующего месяца для заполнения сетки с праздниками
            const totalCells = firstDayOfWeek + lastDay.getDate();
            const remainingCells = 42 - totalCells;
            
            for (let day = 1; day <= remainingCells; day++) {
                const dateCell = document.createElement('div');
                dateCell.className = 'calendar-date other-month';
                dateCell.textContent = day;
                
                // Проверка на праздники для дней следующего месяца
                const cellDate = new Date(now.getFullYear(), now.getMonth() + 1, day);
                if (cellDate.getMonth() === 9 && cellDate.getDate() === 31) { // Хэллоуин 31 октября
                    dateCell.classList.add('halloween');
                } else if (cellDate.getMonth() === 11 && cellDate.getDate() === 31) { // Новый год 31 декабря
                    dateCell.classList.add('new-year');
                } else if (cellDate.getMonth() === 0 && cellDate.getDate() === 1) { // Рождество 1 января
                    dateCell.classList.add('christmas');
                }
                
                calendarDays.appendChild(dateCell);
            }
        }

        function changeCalendarMonth(direction) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + direction);
            updateCalendar();
        }

        // Обновление времени в календаре каждую секунду
        function updateCalendarTime() {
            const now = new Date();
            const calendarTime = document.getElementById('calendarTime');
            const calendarFullDate = document.getElementById('calendarFullDate');
            
            if (calendarTime) {
                calendarTime.textContent = now.toLocaleTimeString('ru-RU', {hour: '2-digit', minute:'2-digit', second:'2-digit'});
            }
            if (calendarFullDate) {
                calendarFullDate.textContent = now.toLocaleDateString('ru-RU', {day: 'numeric', month: 'long', year: 'numeric'});
            }
        }

        setInterval(updateCalendarTime, 1000);

        function toggleCalendar() {
            const calendar = document.getElementById('calendar');
            if (calendar.style.display === 'block') {
                hideCalendar();
            } else {
                showCalendar();
            }
        }

        function showCalendar() {
            const calendar = document.getElementById('calendar');
            // Сбрасываем на текущий месяц при открытии
            currentCalendarDate = new Date();
            updateCalendar();
            calendar.style.display = 'block';
        }

        function hideCalendar() {
            const calendar = document.getElementById('calendar');
            calendar.style.display = 'none';
        }

        // Закрытие календаря при клике вне его
        document.addEventListener('click', function(event) {
            const calendar = document.getElementById('calendar');
            const timeElement = document.querySelector('.taskbar-right');
            
            if (!calendar.contains(event.target) && !timeElement.contains(event.target) && calendar.style.display === 'block') {
                hideCalendar();
            }
        });

        // Переключение темы
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.getElementById('themeToggle');
            
            if (body.classList.contains('light-theme')) {
                body.classList.remove('light-theme');
                themeToggle.textContent = '🌙';
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.add('light-theme');
                themeToggle.textContent = '☀️';
                localStorage.setItem('theme', 'light');
            }
        }

        // Загрузка темы из localStorage
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            const themeToggle = document.getElementById('themeToggle');
            
            if (savedTheme === 'light') {
                document.body.classList.add('light-theme');
                themeToggle.textContent = '☀️';
            } else {
                document.body.classList.remove('light-theme');
                themeToggle.textContent = '🌙';
            }
        }

        // Функции для работы с меню "Пуск" с анимацией
        let isMenuAnimating = false;

        function toggleStartMenu() {
            if (isMenuAnimating) return;
            
            const startMenu = document.getElementById('start-menu');
            const isVisible = startMenu.style.display === 'block';
            
            if (isVisible) {
                // Анимация закрытия
                isMenuAnimating = true;
                startMenu.classList.add('closing');
                
                setTimeout(() => {
                    startMenu.style.display = 'none';
                    startMenu.classList.remove('closing');
                    isMenuAnimating = false;
                }, 250);
            } else {
                // Анимация открытия
                isMenuAnimating = true;
                startMenu.style.display = 'block';
                
                setTimeout(() => {
                    isMenuAnimating = false;
                }, 300);
            }
        }

        // Управление окнами
        const openWindows = new Set();
        const windowStates = new Map();

        function openWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'flex';
            
            // Центрирование окна
            window.style.left = '50%';
            window.style.top = '50%';
            window.style.transform = 'translate(-50%, -50%)';
            
            // Сброс приложений при открытии
            if (windowId === 'calculator') {
                resetCalculator();
            } else if (windowId === 'timer') {
                resetStopwatch();
                resetCountdown();
            }
            
            // Добавление в список открытых окон
            openWindows.add(windowId);
            windowStates.set(windowId, { minimized: false, maximized: false });
            
            // Добавление иконки на панель задач
            addToTaskbar(windowId);
            
            // Закрытие меню с анимацией
            const startMenu = document.getElementById('start-menu');
            if (startMenu.style.display === 'block') {
                isMenuAnimating = true;
                startMenu.classList.add('closing');
                
                setTimeout(() => {
                    startMenu.style.display = 'none';
                    startMenu.classList.remove('closing');
                    isMenuAnimating = false;
                }, 250);
            }
        }

        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            window.style.display = 'none';
            openWindows.delete(windowId);
            windowStates.delete(windowId);
            removeFromTaskbar(windowId);
        }

        function minimizeWindow(windowId) {
            const window = document.getElementById(windowId);
            window.classList.add('minimized');
            windowStates.get(windowId).minimized = true;
            updateTaskbarIcon(windowId);
        }

        function maximizeWindow(windowId) {
            const window = document.getElementById(windowId);
            const state = windowStates.get(windowId);
            
            if (state.maximized) {
                // Восстановление размера
                window.classList.remove('maximized');
                window.style.left = '50%';
                window.style.top = '50%';
                window.style.transform = 'translate(-50%, -50%)';
                state.maximized = false;
            } else {
                // Полноэкранный режим
                window.classList.add('maximized');
                state.maximized = true;
            }
        }

        function restoreWindow(windowId) {
            const window = document.getElementById(windowId);
            window.classList.remove('minimized');
            windowStates.get(windowId).minimized = false;
            updateTaskbarIcon(windowId);
        }

        // Перетаскивание окон с быстрой скоростью
        function initDraggableWindows() {
            const windows = document.querySelectorAll('.window');
            
            windows.forEach(window => {
                const header = window.querySelector('.window-header');
                let isDragging = false;
                let currentX;
                let currentY;
                let initialX;
                let initialY;
                let xOffset = 0;
                let yOffset = 0;
                
                header.addEventListener('mousedown', dragStart);
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', dragEnd);
                
                function dragStart(e) {
                    if (windowStates.get(window.id)?.maximized) return;
                    
                    initialX = e.clientX - xOffset;
                    initialY = e.clientY - yOffset;
                    
                    if (e.target === header || e.target.classList.contains('window-title')) {
                        isDragging = true;
                    }
                }
                
                function drag(e) {
                    if (isDragging) {
                        e.preventDefault();
                        // Быстрая скорость для окон
                        currentX = e.clientX - initialX;
                        currentY = e.clientY - initialY;
                        
                        xOffset = currentX;
                        yOffset = currentY;
                        
                        setTranslate(currentX, currentY, window);
                    }
                }
                
                function dragEnd() {
                    initialX = currentX;
                    initialY = currentY;
                    isDragging = false;
                }
                
                function setTranslate(xPos, yPos, el) {
                    el.style.transform = `translate(${xPos}px, ${yPos}px)`;
                }
            });
        }

        // Панель задач
        function addToTaskbar(windowId) {
            const taskbarApps = document.getElementById('taskbarApps');
            const appIcon = document.createElement('div');
            appIcon.className = 'taskbar-app';
            appIcon.id = `taskbar-${windowId}`;
            appIcon.onclick = () => toggleWindow(windowId);
            
            // Создание SVG иконки для калькулятора
            if (windowId === 'calculator') {
                const svgIcon = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svgIcon.setAttribute('viewBox', '0 0 640 640');
                svgIcon.setAttribute('width', '20');
                svgIcon.setAttribute('height', '20');
                svgIcon.innerHTML = '<path d="M192 64C156.7 64 128 92.7 128 128L128 512C128 547.3 156.7 576 192 576L448 576C483.3 576 512 547.3 512 512L512 128C512 92.7 483.3 64 448 64L192 64zM224 128L416 128C433.7 128 448 142.3 448 160L448 192C448 209.7 433.7 224 416 224L224 224C206.3 224 192 209.7 192 192L192 160C192 142.3 206.3 128 224 128zM240 296C240 309.3 229.3 320 216 320C202.7 320 192 309.3 192 296C192 282.7 202.7 272 216 272C229.3 272 240 282.7 240 296zM320 320C306.7 320 296 309.3 296 296C296 282.7 306.7 272 320 272C333.3 272 344 282.7 344 296C344 309.3 333.3 320 320 320zM448 296C448 309.3 437.3 320 424 320C410.7 320 400 309.3 400 296C400 282.7 410.7 272 424 272C437.3 272 448 282.7 448 296zM216 416C202.7 416 192 405.3 192 392C192 378.7 202.7 368 216 368C229.3 368 240 378.7 240 392C240 405.3 229.3 416 216 416zM344 392C344 405.3 333.3 416 320 416C306.7 416 296 405.3 296 392C296 378.7 306.7 368 320 368C333.3 368 344 378.7 344 392zM424 416C410.7 416 400 405.3 400 392C400 378.7 410.7 368 424 368C437.3 368 448 378.7 448 392C448 405.3 437.3 416 424 416zM192 488C192 474.7 202.7 464 216 464L328 464C341.3 464 352 474.7 352 488C352 501.3 341.3 512 328 512L216 512C202.7 512 192 501.3 192 488zM424 464C437.3 464 448 474.7 448 488C448 501.3 437.3 512 424 512C410.7 512 400 501.3 400 488C400 474.7 410.7 464 424 464z"/>';
                appIcon.appendChild(svgIcon);
            } else {
                const icon = document.createElement('i');
                
                // Установка иконки в зависимости от приложения
                switch(windowId) {
                    case 'notepad':
                        icon.className = 'fa-solid fa-file-lines';
                        break;
                    case 'timer':
                        icon.className = 'fa-solid fa-stopwatch';
                        break;
                    default:
                        icon.className = 'fa-solid fa-window-maximize';
                }
                
                appIcon.appendChild(icon);
            }
            
            taskbarApps.appendChild(appIcon);
            updateTaskbarIcon(windowId);
        }

        function removeFromTaskbar(windowId) {
            const taskbarApp = document.getElementById(`taskbar-${windowId}`);
            if (taskbarApp) {
                taskbarApp.remove();
            }
        }

        function updateTaskbarIcon(windowId) {
            const taskbarApp = document.getElementById(`taskbar-${windowId}`);
            const state = windowStates.get(windowId);
            
            if (taskbarApp && state) {
                if (state.minimized) {
                    taskbarApp.classList.remove('active');
                } else {
                    taskbarApp.classList.add('active');
                }
            }
        }

        function toggleWindow(windowId) {
            const state = windowStates.get(windowId);
            if (state && state.minimized) {
                restoreWindow(windowId);
            } else {
                minimizeWindow(windowId);
            }
        }

        // Закрытие меню "Пуск" при клике вне его
        document.addEventListener('click', function(event) {
            const startMenu = document.getElementById('start-menu');
            const startButton = document.querySelector('.start-button');
            
            if (!startMenu.contains(event.target) && !startButton.contains(event.target) && startMenu.style.display === 'block' && !isMenuAnimating) {
                isMenuAnimating = true;
                startMenu.classList.add('closing');
                
                setTimeout(() => {
                    startMenu.style.display = 'none';
                    startMenu.classList.remove('closing');
                    isMenuAnimating = false;
                }, 250);
            }
        });

        // Функции калькулятора с валидацией
        let currentDisplay = '0';
        let shouldResetDisplay = false;
        let hasDecimalPoint = false;
        let lastOperator = '';

        function resetCalculator() {
            currentDisplay = '0';
            shouldResetDisplay = false;
            hasDecimalPoint = false;
            lastOperator = '';
            updateDisplay();
            updateDecimalButton();
        }

        function updateDisplay() {
            document.getElementById('calcDisplay').textContent = currentDisplay;
        }

        function updateDecimalButton() {
            const decimalBtn = document.getElementById('decimalBtn');
            if (hasDecimalPoint) {
                decimalBtn.disabled = true;
            } else {
                decimalBtn.disabled = false;
            }
        }

        function isValidInput(value) {
            const operators = ['+', '-', '*', '/', '×'];
            const lastChar = currentDisplay.slice(-1);
            
            // Нельзя добавить оператор если display пустой или уже содержит оператор
            if (operators.includes(value)) {
                if (currentDisplay === '0' || operators.includes(lastChar)) {
                    return false;
                }
            }
            
            // Нельзя добавить точку если она уже есть в текущем числе
            if (value === '.') {
                if (hasDecimalPoint) return false;
                
                // Если последний символ - оператор, то можно добавить точку
                if (operators.includes(lastChar)) {
                    return true;
                }
            }
            
            return true;
        }

        function appendToDisplay(value) {
            if (!isValidInput(value)) return;
            
            if (currentDisplay === '0' || shouldResetDisplay) {
                if (value === '.') {
                    currentDisplay = '0.';
                } else {
                    currentDisplay = value;
                }
                shouldResetDisplay = false;
                hasDecimalPoint = value === '.';
            } else {
                // Проверка на множественные точки
                if (value === '.' && hasDecimalPoint) {
                    return; // Не добавляем точку, если она уже есть
                }
                
                if (value === '.') {
                    hasDecimalPoint = true;
                }
                
                // Если добавляем оператор после числа, сбрасываем флаг точки
                if (['+', '-', '*', '/', '×'].includes(value)) {
                    hasDecimalPoint = false;
                    lastOperator = value;
                }
                
                currentDisplay += value;
            }
            updateDisplay();
            updateDecimalButton();
        }

        function clearCalculator() {
            currentDisplay = '0';
            hasDecimalPoint = false;
            lastOperator = '';
            updateDisplay();
            updateDecimalButton();
        }

        function backspace() {
            if (currentDisplay.length > 1) {
                // Проверяем, удаляем ли мы точку
                if (currentDisplay.slice(-1) === '.') {
                    hasDecimalPoint = false;
                }
                // Проверяем, удаляем ли мы оператор
                if (['+', '-', '*', '/', '×'].includes(currentDisplay.slice(-1))) {
                    lastOperator = '';
                }
                currentDisplay = currentDisplay.slice(0, -1);
            } else {
                currentDisplay = '0';
                hasDecimalPoint = false;
                lastOperator = '';
            }
            updateDisplay();
            updateDecimalButton();
        }

        function calculate() {
            try {
                // Заменяем × на * для вычисления
                let expression = currentDisplay.replace(/×/g, '*');
                
                // Проверяем, что выражение заканчивается числом, а не оператором
                if (['+', '-', '*', '/', '×'].includes(expression.slice(-1))) {
                    currentDisplay = 'Ошибка';
                } else {
                    const result = eval(expression);
                    // Проверяем на бесконечность и NaN
                    if (!isFinite(result)) {
                        currentDisplay = 'Ошибка';
                    } else {
                        currentDisplay = result.toString();
                        // Сбрасываем флаг точки после вычисления
                        hasDecimalPoint = currentDisplay.includes('.');
                    }
                }
            } catch (error) {
                currentDisplay = 'Ошибка';
                hasDecimalPoint = false;
            }
            shouldResetDisplay = true;
            lastOperator = '';
            updateDisplay();
            updateDecimalButton();
        }

        // Функции блокнота
        function saveNote() {
            const text = document.getElementById('notepadText').value;
            localStorage.setItem('notepadContent', text);
            alert('Текст сохранен!');
        }

        function clearNote() {
            if (confirm('Очистить блокнот?')) {
                document.getElementById('notepadText').value = '';
            }
        }

        // Загрузка сохраненного текста блокнота
        function loadNote() {
            const savedText = localStorage.getItem('notepadContent');
            if (savedText) {
                document.getElementById('notepadText').value = savedText;
            }
        }

        // Функции таймера и секундомера
        let stopwatchInterval;
        let stopwatchRunning = false;
        let stopwatchTime = 0;
        let lapCount = 1;

        let countdownInterval;
        let countdownRunning = false;
        let countdownTime = 0;
        let countdownTotalTime = 0;

        function switchTab(tab) {
            document.querySelectorAll('.timer-tab').forEach(btn => btn.classList.remove('active'));
            document.getElementById('stopwatchTab').style.display = 'none';
            document.getElementById('countdownTab').style.display = 'none';
            
            if (tab === 'stopwatch') {
                document.querySelector('.timer-tab:nth-child(1)').classList.add('active');
                document.getElementById('stopwatchTab').style.display = 'block';
            } else {
                document.querySelector('.timer-tab:nth-child(2)').classList.add('active');
                document.getElementById('countdownTab').style.display = 'block';
            }
        }

        function toggleStopwatch() {
            if (stopwatchRunning) {
                stopStopwatch();
            } else {
                startStopwatch();
            }
        }

        function startStopwatch() {
            stopwatchRunning = true;
            document.getElementById('startStopwatch').textContent = 'Стоп';
            stopwatchInterval = setInterval(() => {
                stopwatchTime++;
                updateStopwatchDisplay();
            }, 1000);
        }

        function stopStopwatch() {
            stopwatchRunning = false;
            document.getElementById('startStopwatch').textContent = 'Старт';
            clearInterval(stopwatchInterval);
        }

        function resetStopwatch() {
            stopStopwatch();
            stopwatchTime = 0;
            lapCount = 1;
            updateStopwatchDisplay();
            document.getElementById('stopwatchLaps').innerHTML = '';
        }

        function lapStopwatch() {
            if (stopwatchRunning) {
                const lapsContainer = document.getElementById('stopwatchLaps');
                const lapTime = formatTime(stopwatchTime);
                const lapItem = document.createElement('div');
                lapItem.className = 'lap-item';
                lapItem.textContent = `Круг ${lapCount}: ${lapTime}`;
                lapsContainer.appendChild(lapItem);
                lapCount++;
                lapsContainer.scrollTop = lapsContainer.scrollHeight;
            }
        }

        function updateStopwatchDisplay() {
            document.getElementById('stopwatchDisplay').textContent = formatTime(stopwatchTime);
        }

        function formatTime(seconds) {
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function formatMinutesSeconds(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function toggleCountdown() {
            if (countdownRunning) {
                stopCountdown();
            } else {
                startCountdown();
            }
        }

        function startCountdown() {
            if (!countdownRunning) {
                const input = document.getElementById('countdownInput').value;
                const timeParts = input.split(':');
                
                if (timeParts.length === 2) {
                    const minutes = parseInt(timeParts[0]);
                    const seconds = parseInt(timeParts[1]);
                    
                    if (!isNaN(minutes) && !isNaN(seconds) && minutes >= 0 && seconds >= 0) {
                        countdownTotalTime = minutes * 60 + seconds;
                        countdownTime = countdownTotalTime;
                        countdownRunning = true;
                        document.getElementById('startCountdown').textContent = 'Стоп';
                        
                        updateCircularTimer();
                        
                        countdownInterval = setInterval(() => {
                            if (countdownTime > 0) {
                                countdownTime--;
                                updateCircularTimer();
                            } else {
                                stopCountdown();
                                alert('Время вышло!');
                            }
                        }, 1000);
                    } else {
                        alert('Введите корректное время');
                    }
                } else {
                    alert('Введите время в формате ММ:СС');
                }
            }
        }

        function stopCountdown() {
            countdownRunning = false;
            document.getElementById('startCountdown').textContent = 'Старт';
            clearInterval(countdownInterval);
        }

        function resetCountdown() {
            stopCountdown();
            countdownTime = 0;
            countdownTotalTime = 0;
            updateCircularTimer();
            document.getElementById('countdownInput').value = '';
        }

        function updateCircularTimer() {
            const progressCircle = document.querySelector('.circular-timer-progress');
            const timerText = document.getElementById('circularTimerText');
            
            if (countdownTotalTime > 0) {
                const progress = 1 - (countdownTime / countdownTotalTime);
                const circumference = 283; // 2 * π * 45
                const offset = circumference - (progress * circumference);
                
                progressCircle.style.strokeDashoffset = offset;
                timerText.textContent = formatMinutesSeconds(countdownTime);
            } else {
                progressCircle.style.strokeDashoffset = 283;
                timerText.textContent = '00:00';
            }
        }

        // Инициализация при загрузке
        window.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            resetCalculator();
            loadNote();
            initDraggableWindows();
            loadUsername();
        });
    </script>
</body>
</html>